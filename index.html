<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noris ðŸ’œ</title>

    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000;
            font-family: 'Georgia', 'Times New Roman', serif;
        }

        #fase-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            transition: opacity 1.5s ease-in-out;
        }

        #video-fondo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
        }

        #overlay-oscuro {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.35);
            z-index: 2;
        }

        #contenedor-texto {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            text-align: center;
            width: 90%;
            max-width: 800px;
        }

        #texto-animado {
            color: #fff;
            font-size: clamp(1.8rem, 5vw, 4rem);
            text-shadow:
                0 0 10px rgba(155, 89, 182, 0.8),
                0 0 20px rgba(155, 89, 182, 0.6),
                0 0 40px rgba(155, 89, 182, 0.4),
                2px 2px 4px rgba(0, 0, 0, 0.8);
            letter-spacing: 3px;
            line-height: 1.4;
            font-style: italic;
            white-space: pre-wrap;
            min-height: 2em;
        }

        #cursor {
            display: inline-block;
            width: 3px;
            height: 1em;
            background-color: #9b59b6;
            margin-left: 4px;
            vertical-align: text-bottom;
            animation: parpadeo 0.6s infinite;
        }

        @keyframes parpadeo {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        #fase-gif {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            display: none;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        #video-borroso {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
            filter: blur(15px) brightness(0.5);
        }

        #contenedor-gif {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            z-index: 11;
            text-align: center;
            opacity: 0;
            transition: all 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        #contenedor-gif.visible {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        /* Marco brillante del gif del gato */
        #marco-gif {
            position: relative;
            display: inline-block;
            border-radius: 24px;
            cursor: pointer;
            animation: zoom-gato 3s ease-in-out infinite;
        }

        @keyframes zoom-gato {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.06); }
        }

        /* Borde brillante animado pastel morado */
        #marco-gif::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border-radius: 26px;
            background: linear-gradient(
                45deg,
                #d8b4fe,
                #c084fc,
                #a855f7,
                #e9d5ff,
                #c4b5fd,
                #a78bfa,
                #d8b4fe
            );
            background-size: 300% 300%;
            animation: borde-brillo 3s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes borde-brillo {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Resplandor trasero */
        #marco-gif::after {
            content: '';
            position: absolute;
            top: -15px;
            left: -15px;
            right: -15px;
            bottom: -15px;
            border-radius: 30px;
            background: transparent;
            box-shadow:
                0 0 20px rgba(216, 180, 254, 0.4),
                0 0 40px rgba(192, 132, 252, 0.3),
                0 0 60px rgba(168, 85, 247, 0.2),
                0 0 80px rgba(216, 180, 254, 0.15);
            animation: resplandor-trasero 2.5s ease-in-out infinite;
            z-index: -2;
        }

        @keyframes resplandor-trasero {
            0%, 100% {
                box-shadow:
                    0 0 20px rgba(216, 180, 254, 0.3),
                    0 0 40px rgba(192, 132, 252, 0.2),
                    0 0 60px rgba(168, 85, 247, 0.1);
            }
            50% {
                box-shadow:
                    0 0 30px rgba(216, 180, 254, 0.6),
                    0 0 60px rgba(192, 132, 252, 0.4),
                    0 0 90px rgba(168, 85, 247, 0.3),
                    0 0 120px rgba(233, 213, 255, 0.2);
            }
        }

        #gif-gato {
            max-width: 80vw;
            max-height: 55vh;
            border-radius: 20px;
            display: block;
            border: none;
            box-shadow: none;
        }

        #texto-toca-gato {
            color: rgba(216, 180, 254, 0.7);
            font-size: clamp(0.8rem, 2vw, 1rem);
            margin-top: 18px;
            animation: parpadeo-suave 2s ease-in-out infinite;
            letter-spacing: 1px;
        }

        #texto-final {
            color: #c084fc;
            font-size: clamp(1.2rem, 3vw, 2.5rem);
            margin-top: 20px;
            text-shadow:
                0 0 10px rgba(192, 132, 252, 0.8),
                0 0 20px rgba(192, 132, 252, 0.5);
            opacity: 0;
            transition: opacity 1s ease-in-out 0.5s;
        }

        #texto-final.visible {
            opacity: 1;
        }

        .corazon {
            position: fixed;
            z-index: 20;
            font-size: 1.5rem;
            opacity: 0;
            pointer-events: none;
            animation: flotar-corazon 4s ease-in-out forwards;
        }

        @keyframes flotar-corazon {
            0% { opacity: 0; transform: translateY(0) scale(0.5); }
            20% { opacity: 1; }
            100% { opacity: 0; transform: translateY(-100vh) scale(1.2); }
        }

        #boton-inicio {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: clamp(1.2rem, 3vw, 2rem);
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Georgia', serif;
            box-shadow:
                0 0 20px rgba(155, 89, 182, 0.6),
                0 0 40px rgba(155, 89, 182, 0.3);
            transition: all 0.3s ease;
            animation: pulsar-boton 2s ease-in-out infinite;
        }

        #boton-inicio:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow:
                0 0 30px rgba(155, 89, 182, 0.8),
                0 0 60px rgba(155, 89, 182, 0.5);
        }

        @keyframes pulsar-boton {
            0%, 100% { box-shadow: 0 0 20px rgba(155, 89, 182, 0.6); }
            50% { box-shadow: 0 0 40px rgba(155, 89, 182, 0.9), 0 0 80px rgba(155, 89, 182, 0.4); }
        }

        .particula {
            position: fixed;
            width: 4px;
            height: 4px;
            background: #9b59b6;
            border-radius: 50%;
            pointer-events: none;
            z-index: 15;
            opacity: 0;
        }

        /* Fase 3: Mensajes secretos */
        #fase-mensajes {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 50;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background: rgba(0, 0, 0, 0.9);
        }

        #fase-mensajes.visible { opacity: 1; }

        #contenedor-mensaje-secreto {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 85%;
            max-width: 700px;
        }

        #mensaje-secreto-texto {
            color: #fff;
            font-size: clamp(1.4rem, 4vw, 2.8rem);
            text-shadow:
                0 0 10px rgba(155, 89, 182, 0.8),
                0 0 20px rgba(155, 89, 182, 0.6),
                0 0 40px rgba(155, 89, 182, 0.4);
            line-height: 1.6;
            font-style: italic;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            white-space: pre-wrap;
        }

        #mensaje-secreto-texto.visible { opacity: 1; }

        #mensaje-secreto-texto.texto-largo {
            font-size: clamp(1rem, 2.8vw, 1.6rem);
            line-height: 1.8;
        }

        #mensaje-secreto-texto.texto-teamo {
            font-size: clamp(3rem, 12vw, 8rem);
            font-weight: bold;
            font-style: normal;
            text-shadow:
                0 0 20px rgba(155, 89, 182, 1),
                0 0 40px rgba(155, 89, 182, 0.8),
                0 0 80px rgba(155, 89, 182, 0.6),
                0 0 120px rgba(155, 89, 182, 0.4);
            animation: latido-teamo 1.5s ease-in-out infinite;
        }

        @keyframes latido-teamo {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Corazon interactivo que late y brilla */
        #corazon-teamo {
            display: inline-block;
            cursor: pointer;
            position: relative;
            animation: latido-corazon 1.2s ease-in-out infinite;
            filter: drop-shadow(0 0 8px rgba(216, 180, 254, 0.8));
            font-size: 1em;
        }

        @keyframes latido-corazon {
            0% {
                transform: scale(1);
                filter:
                    drop-shadow(0 0 5px rgba(216, 180, 254, 0.4))
                    drop-shadow(0 0 10px rgba(192, 132, 252, 0.2));
            }
            15% {
                transform: scale(1.25);
                filter:
                    drop-shadow(0 0 15px rgba(216, 180, 254, 0.9))
                    drop-shadow(0 0 30px rgba(192, 132, 252, 0.6))
                    drop-shadow(0 0 50px rgba(168, 85, 247, 0.3));
            }
            30% {
                transform: scale(1);
                filter:
                    drop-shadow(0 0 5px rgba(216, 180, 254, 0.4))
                    drop-shadow(0 0 10px rgba(192, 132, 252, 0.2));
            }
            45% {
                transform: scale(1.18);
                filter:
                    drop-shadow(0 0 12px rgba(216, 180, 254, 0.8))
                    drop-shadow(0 0 25px rgba(192, 132, 252, 0.5))
                    drop-shadow(0 0 40px rgba(233, 213, 255, 0.3));
            }
            60%, 100% {
                transform: scale(1);
                filter:
                    drop-shadow(0 0 5px rgba(216, 180, 254, 0.4))
                    drop-shadow(0 0 10px rgba(192, 132, 252, 0.2));
            }
        }

        #pista-corazon {
            display: block;
            color: rgba(216, 180, 254, 0.5);
            font-size: clamp(0.7rem, 1.8vw, 0.95rem);
            font-weight: 300;
            font-style: italic;
            margin-top: 25px;
            animation: parpadeo-pista 2.5s ease-in-out infinite;
            letter-spacing: 1px;
        }

        @keyframes parpadeo-pista {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }

        #cursor-mensaje {
            display: inline-block;
            width: 3px;
            height: 1em;
            background-color: #9b59b6;
            margin-left: 4px;
            vertical-align: text-bottom;
            animation: parpadeo 0.6s infinite;
        }

        /* Indicador toca para continuar - MAS EVIDENTE */
        #indicador-toca {
            position: absolute;
            bottom: 8%;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(216, 180, 254, 0.8);
            font-size: clamp(0.95rem, 2.5vw, 1.2rem);
            letter-spacing: 2px;
            padding: 12px 30px;
            border: 1px solid rgba(216, 180, 254, 0.3);
            border-radius: 30px;
            background: rgba(155, 89, 182, 0.1);
            animation: indicador-pulso 2s ease-in-out infinite;
        }

        @keyframes indicador-pulso {
            0%, 100% {
                opacity: 0.6;
                border-color: rgba(216, 180, 254, 0.2);
                background: rgba(155, 89, 182, 0.05);
            }
            50% {
                opacity: 1;
                border-color: rgba(216, 180, 254, 0.5);
                background: rgba(155, 89, 182, 0.15);
            }
        }

        @keyframes parpadeo-suave {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }

        /* Fase 4: Easter egg */
        #fase-easter {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 60;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background: #0a0a0a;
            font-family: 'Cormorant Garamond', 'Georgia', serif;
            overflow-y: auto;
        }

        #fase-easter.visible { opacity: 1; }

        #easter-contenido {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 85%;
            max-width: 650px;
            padding: 40px 20px;
        }

        #easter-texto {
            color: #e0e0e0;
            font-size: clamp(1.6rem, 4vw, 3rem);
            font-weight: 300;
            line-height: 1.6;
            letter-spacing: 2px;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
        }

        #easter-texto.visible { opacity: 1; }

        .cursor-easter {
            display: inline-block;
            width: 2px;
            height: 1em;
            background-color: rgba(155, 89, 182, 0.6);
            margin-left: 3px;
            vertical-align: text-bottom;
            animation: parpadeo 0.6s infinite;
        }

        #easter-opciones {
            display: none;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            margin-top: 60px;
        }

        #easter-opciones.visible { opacity: 1; }

        .opcion-flotante {
            display: inline-block;
            color: rgba(224, 224, 224, 0.7);
            font-size: clamp(1.4rem, 3.5vw, 2.2rem);
            font-weight: 300;
            letter-spacing: 4px;
            margin: 0 30px;
            cursor: pointer;
            transition: all 0.4s ease;
            text-transform: lowercase;
            font-family: 'Cormorant Garamond', 'Georgia', serif;
            border: none;
            background: none;
            padding: 15px 25px;
            position: relative;
        }

        .opcion-flotante::after {
            content: '';
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 1px;
            background: rgba(155, 89, 182, 0.5);
            transition: width 0.4s ease;
        }

        .opcion-flotante:hover {
            color: #e0e0e0;
            transform: scale(1.15);
            opacity: 1;
        }

        .opcion-flotante:hover::after { width: 80%; }

        .separador-opciones {
            display: inline-block;
            color: rgba(155, 89, 182, 0.3);
            font-size: 1.5rem;
            margin: 0 10px;
            vertical-align: middle;
        }

        /* Indicador easter - MAS EVIDENTE */
        #easter-indicador {
            position: absolute;
            bottom: 8%;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(216, 180, 254, 0.8);
            font-size: clamp(0.9rem, 2.2vw, 1.1rem);
            font-family: 'Cormorant Garamond', 'Georgia', serif;
            letter-spacing: 2px;
            padding: 10px 28px;
            border: 1px solid rgba(216, 180, 254, 0.3);
            border-radius: 30px;
            background: rgba(155, 89, 182, 0.08);
            animation: indicador-pulso 2s ease-in-out infinite;
        }

        /* Fase 5: Final */
        #fase-final {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 70;
            display: none;
            opacity: 0;
            transition: all 1.5s ease-in-out;
            font-family: 'Cormorant Garamond', 'Georgia', serif;
            overflow-y: auto;
        }

        #fase-final.visible { opacity: 1; }

        #fase-final.fondo-luz {
            background: linear-gradient(160deg, #1a1008 0%, #2a1a0a 30%, #1f150a 60%, #0f0a05 100%);
        }

        #fase-final.fondo-sombras {
            background: linear-gradient(160deg, #080c14 0%, #0a1020 30%, #0c1428 60%, #060a12 100%);
        }

        #final-contenido {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px 20px;
            text-align: center;
        }

        .final-texto {
            color: #e0e0e0;
            font-size: clamp(1.1rem, 2.8vw, 1.5rem);
            font-weight: 300;
            line-height: 2.2;
            letter-spacing: 1px;
            max-width: 600px;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            margin-bottom: 35px;
        }

        .final-texto.visible { opacity: 1; }

        .final-texto.texto-luz-principal {
            font-size: clamp(1.3rem, 3.5vw, 2rem);
            font-style: italic;
            line-height: 1.8;
        }

        .final-linea-pequena {
            color: rgba(155, 89, 182, 0.5);
            font-size: clamp(0.8rem, 2vw, 1rem);
            font-weight: 300;
            font-style: italic;
            letter-spacing: 1px;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            margin-top: 40px;
        }

        .final-linea-pequena.visible { opacity: 1; }

        @media (max-width: 768px) {
            #gif-gato { max-width: 85vw; max-height: 45vh; }
            #contenedor-texto { width: 95%; }
            #boton-inicio { padding: 15px 35px; }
            #contenedor-mensaje-secreto { width: 90%; }
            .opcion-flotante { margin: 10px 15px; display: block; }
            .separador-opciones { display: block; margin: 5px 0; }
            #easter-contenido { width: 90%; }
        }

        @media (max-width: 480px) {
            #gif-gato { max-width: 90vw; max-height: 40vh; border-radius: 15px; }
            #contenedor-mensaje-secreto { width: 93%; }
            #easter-contenido { width: 93%; padding: 30px 15px; }
            #marco-gif { border-radius: 18px; }
            #marco-gif::before { border-radius: 20px; }
            #marco-gif::after { border-radius: 22px; }
        }
    </style>
</head>
<body>

    <button id="boton-inicio">ðŸ’œ Toca para comenzar ðŸ’œ</button>

    <div id="fase-video">
        <video id="video-fondo" muted playsinline>
            <source src="video.mp4" type="video/mp4">
        </video>
        <div id="overlay-oscuro"></div>
        <div id="contenedor-texto">
            <span id="texto-animado"></span>
            <span id="cursor">|</span>
        </div>
    </div>

    <div id="fase-gif">
        <video id="video-borroso" loop muted playsinline>
            <source src="video.mp4" type="video/mp4">
        </video>
        <div id="contenedor-gif">
            <div id="marco-gif">
                <img id="gif-gato" src="imagen uno.jpeg" alt="Gatito con flor">
            </div>
            <div id="texto-toca-gato">&#10024; toca al gatito &#10024;</div>
            <div id="texto-final">ðŸ’œ Te quiero mucho, Noris ðŸ’œ</div>
        </div>
    </div>

    <div id="fase-mensajes">
        <div id="contenedor-mensaje-secreto">
            <div id="mensaje-secreto-texto"></div>
        </div>
        <div id="indicador-toca">&#10024; toca para continuar &#10024;</div>
    </div>

    <div id="fase-easter">
        <div id="easter-contenido">
            <div id="easter-texto"></div>
            <div id="easter-opciones">
                <span class="opcion-flotante" id="opcion-luz">luz</span>
                <span class="separador-opciones">|</span>
                <span class="opcion-flotante" id="opcion-sombras">sombras</span>
            </div>
        </div>
        <div id="easter-indicador">&#10024; toca para continuar &#10024;</div>
    </div>

    <div id="fase-final">
        <div id="final-contenido"></div>
    </div>

    <!-- AUDIOS -->
    <audio id="audio-principal" preload="auto">
        <source src="video audio.mpeg" type="audio/mpeg">
    </audio>
    <audio id="audio-typewriter" preload="auto" loop>
        <source src="maquina de escribir audio.mpeg" type="audio/mpeg">
    </audio>
    <audio id="audio-burbuja" preload="auto" loop>
        <source src="audio de burbuja.mpeg" type="audio/mpeg">
    </audio>
    <audio id="audio-burbuja-corto" preload="auto">
        <source src="audio de burbuja.mpeg" type="audio/mpeg">
    </audio>

    <!-- ============================================= -->
    <!-- CANCION DE FONDO PARA EL EASTER EGG            -->
    <!-- CAMBIA "cancion-easter.mp3" POR TU ARCHIVO     -->
    <!-- ============================================= -->
    <audio id="audio-easter-fondo" preload="auto" loop>
        <source src="cancion-easter.mp3" type="audio/mpeg">
    </audio>

    <script>
        var MENSAJE = "Feliz 14 de Febrero\nNoris ðŸ’œ";
        var DURACION_VIDEO = 13000;
        var ESPERA_INICIO_TEXTO = 1500;
        var TIEMPO_DISPONIBLE_TEXTO = DURACION_VIDEO - ESPERA_INICIO_TEXTO - 2000;
        var VELOCIDAD_LETRA = Math.floor(TIEMPO_DISPONIBLE_TEXTO / MENSAJE.length);
        var IMAGEN_GATO_1 = "imagen uno.jpeg";
        var IMAGEN_GATO_2 = "iamgen 2.jpeg";
        var VELOCIDAD_GIF = 600;
        var VELOCIDAD_MENSAJE_TYPEWRITER = 55;
        var VELOCIDAD_EASTER_TYPEWRITER = 50;

        var MENSAJES_SECRETOS = [
            { texto: "Ya veo... \uD83D\uDC40", tipo: "normal" },
            { texto: "Andas por aqui otra vez  \uD83D\uDE0F\uD83D\uDC9C", tipo: "normal" },
            { texto: "Toma esto... \uD83C\uDF81", tipo: "normal" },
            {
                texto: "En algun lugar de estas infinitas palabras organizadas, esta este texto. Texto que se creo pensando en ti, por un impulso que nacio del azar, espontaneo e imparcial, incluso inalterable. Texto el cual se escribio con el unico fin de recordarte que...",
                tipo: "typewriter"
            },
            { texto: "TE AMO", tipo: "teamo" }
        ];

        var EASTER_MENSAJES = [
            "\u00BFMas?",
            "\u00BFAun quieres mas?",
            "\u00BFAlgo mas?"
        ];

        var SOMBRAS_PARTES = [
            "Hace un tiempo llegue a la conclusion de que el ser humano es insaciable; nunca esta completamente satisfecho.",
            "Por eso, a veces fuerza las cosas con la esperanza de llenar ese vacio.",
            "Sin embargo, ese impulso termina llevando al limite a quienes estan involucrados.",
            "Y lo que ya era hermoso comienza a marchitarse bajo el peso de la sobre exigencia y las expectativas.",
            "Es ironico: se puede perder todo por el simple deseo de tener un poco mas."
        ];

        var botonInicio = document.getElementById('boton-inicio');
        var faseVideo = document.getElementById('fase-video');
        var faseGif = document.getElementById('fase-gif');
        var faseMensajes = document.getElementById('fase-mensajes');
        var faseEaster = document.getElementById('fase-easter');
        var faseFinal = document.getElementById('fase-final');
        var videoFondo = document.getElementById('video-fondo');
        var videoBorroso = document.getElementById('video-borroso');
        var textoAnimado = document.getElementById('texto-animado');
        var cursorElemento = document.getElementById('cursor');
        var contenedorGif = document.getElementById('contenedor-gif');
        var marcoGif = document.getElementById('marco-gif');
        var gifGato = document.getElementById('gif-gato');
        var textoFinal = document.getElementById('texto-final');
        var audioPrincipal = document.getElementById('audio-principal');
        var audioTypewriter = document.getElementById('audio-typewriter');
        var audioBurbuja = document.getElementById('audio-burbuja');
        var audioBurbujaCorto = document.getElementById('audio-burbuja-corto');
        var audioEasterFondo = document.getElementById('audio-easter-fondo');
        var mensajeSecretoTexto = document.getElementById('mensaje-secreto-texto');
        var indicadorToca = document.getElementById('indicador-toca');
        var easterTexto = document.getElementById('easter-texto');
        var easterOpciones = document.getElementById('easter-opciones');
        var easterIndicador = document.getElementById('easter-indicador');
        var opcionLuz = document.getElementById('opcion-luz');
        var opcionSombras = document.getElementById('opcion-sombras');
        var finalContenido = document.getElementById('final-contenido');

        var indiceLetra = 0;
        var intervaloTexto = null;
        var intervaloGif = null;
        var imagenActual = 1;
        var transicionEjecutada = false;
        var indiceMensaje = 0;
        var mensajesActivados = false;
        var puedeAvanzar = false;
        var typewriterMensajeIntervalo = null;
        var typewriterMensajeTerminado = false;
        var easterActivado = false;
        var easterIndice = 0;
        var easterPuedeAvanzar = false;
        var easterTypewriterIntervalo = null;
        var easterTypewriterTerminado = false;
        var easterFaseActual = "mensajes";

        function reproducirBurbujaCorta() {
            audioBurbujaCorto.currentTime = 0;
            audioBurbujaCorto.volume = 0.7;
            audioBurbujaCorto.play().catch(function(e) {});
        }

        function iniciarAudioMaquina() {
            audioTypewriter.currentTime = 0;
            audioTypewriter.volume = 0.4;
            audioTypewriter.play().catch(function(e) {});
        }

        function detenerAudioMaquina() {
            audioTypewriter.pause();
            audioTypewriter.currentTime = 0;
        }

        botonInicio.addEventListener('click', function() {
            var btn = this;
            btn.style.transition = 'opacity 0.5s ease';
            btn.style.opacity = '0';
            setTimeout(function() {
                btn.style.display = 'none';
                iniciarExperiencia();
            }, 500);
        });

        function iniciarExperiencia() {
            videoFondo.play().catch(function(e) {});
            audioPrincipal.play().catch(function(e) {});
            setTimeout(function() {
                iniciarTextoTypewriterFase1();
            }, ESPERA_INICIO_TEXTO);
            videoFondo.addEventListener('ended', transicionAFase2);
            setTimeout(function() {
                transicionAFase2();
            }, DURACION_VIDEO + 500);
            iniciarCorazones();
        }

        function iniciarTextoTypewriterFase1() {
            audioTypewriter.volume = 0.5;
            audioTypewriter.play().catch(function(e) {});
            intervaloTexto = setInterval(function() {
                if (indiceLetra < MENSAJE.length) {
                    var letra = MENSAJE[indiceLetra];
                    if (letra === '\n') {
                        textoAnimado.innerHTML += '<br>';
                    } else {
                        textoAnimado.innerHTML += letra;
                    }
                    indiceLetra++;
                } else {
                    clearInterval(intervaloTexto);
                    detenerAudioMaquina();
                    setTimeout(function() {
                        cursorElemento.style.display = 'none';
                    }, 1000);
                }
            }, VELOCIDAD_LETRA);
        }

        function transicionAFase2() {
            if (transicionEjecutada) return;
            transicionEjecutada = true;
            if (intervaloTexto) {
                clearInterval(intervaloTexto);
                detenerAudioMaquina();
            }
            faseVideo.style.opacity = '0';
            setTimeout(function() {
                faseVideo.style.display = 'none';
                faseGif.style.display = 'block';
                videoBorroso.play().catch(function(e) {});
                requestAnimationFrame(function() {
                    faseGif.style.opacity = '1';
                });
                setTimeout(function() {
                    contenedorGif.classList.add('visible');
                    iniciarGifManual();
                    audioBurbuja.volume = 0.5;
                    audioBurbuja.play().catch(function(e) {});
                    setTimeout(function() {
                        textoFinal.classList.add('visible');
                    }, 800);
                }, 500);
            }, 1500);
        }

        function iniciarGifManual() {
            intervaloGif = setInterval(function() {
                if (imagenActual === 1) {
                    gifGato.src = IMAGEN_GATO_2;
                    imagenActual = 2;
                } else {
                    gifGato.src = IMAGEN_GATO_1;
                    imagenActual = 1;
                }
            }, VELOCIDAD_GIF);
        }

        marcoGif.addEventListener('click', function() {
            if (mensajesActivados) return;
            mensajesActivados = true;
            if (intervaloGif) clearInterval(intervaloGif);
            audioBurbuja.pause();
            audioBurbuja.currentTime = 0;
            faseGif.style.opacity = '0';
            setTimeout(function() {
                faseGif.style.display = 'none';
                faseMensajes.style.display = 'block';
                requestAnimationFrame(function() {
                    faseMensajes.classList.add('visible');
                });
                setTimeout(function() {
                    mostrarMensajeSecreto(0);
                }, 800);
            }, 1000);
        });

        function mostrarMensajeSecreto(indice) {
            if (indice >= MENSAJES_SECRETOS.length) return;
            indiceMensaje = indice;
            var mensaje = MENSAJES_SECRETOS[indice];
            if (typewriterMensajeIntervalo) {
                clearInterval(typewriterMensajeIntervalo);
                typewriterMensajeIntervalo = null;
            }
            typewriterMensajeTerminado = false;
            mensajeSecretoTexto.classList.remove('visible');

            setTimeout(function() {
                mensajeSecretoTexto.className = '';
                mensajeSecretoTexto.innerHTML = '';

                if (mensaje.tipo === "normal") {
                    reproducirBurbujaCorta();
                    mensajeSecretoTexto.innerHTML = mensaje.texto;
                    requestAnimationFrame(function() {
                        mensajeSecretoTexto.classList.add('visible');
                    });
                    puedeAvanzar = false;
                    setTimeout(function() { puedeAvanzar = true; }, 1500);
                }

                else if (mensaje.tipo === "typewriter") {
                    reproducirBurbujaCorta();
                    mensajeSecretoTexto.classList.add('texto-largo');
                    requestAnimationFrame(function() {
                        mensajeSecretoTexto.classList.add('visible');
                    });
                    indicadorToca.style.opacity = '0';
                    puedeAvanzar = false;
                    iniciarAudioMaquina();
                    var textoCompleto = mensaje.texto;
                    var letraActual = 0;
                    mensajeSecretoTexto.innerHTML = '<span id="cursor-mensaje">|</span>';
                    typewriterMensajeIntervalo = setInterval(function() {
                        if (letraActual < textoCompleto.length) {
                            var cursorMsg = document.getElementById('cursor-mensaje');
                            if (cursorMsg) {
                                var textoNodo = document.createTextNode(textoCompleto[letraActual]);
                                cursorMsg.parentNode.insertBefore(textoNodo, cursorMsg);
                            }
                            letraActual++;
                        } else {
                            clearInterval(typewriterMensajeIntervalo);
                            typewriterMensajeIntervalo = null;
                            typewriterMensajeTerminado = true;
                            detenerAudioMaquina();
                            setTimeout(function() {
                                var cursorMsg = document.getElementById('cursor-mensaje');
                                if (cursorMsg) cursorMsg.style.display = 'none';
                            }, 1000);
                            indicadorToca.style.opacity = '1';
                            setTimeout(function() { puedeAvanzar = true; }, 1500);
                        }
                    }, VELOCIDAD_MENSAJE_TYPEWRITER);
                }

                else if (mensaje.tipo === "teamo") {
                    reproducirBurbujaCorta();
                    mensajeSecretoTexto.innerHTML = 'TE AMO <span id="corazon-teamo">\uD83D\uDC9C</span><span id="pista-corazon">toca el \uD83D\uDC9C</span>';
                    mensajeSecretoTexto.classList.add('texto-teamo');
                    requestAnimationFrame(function() {
                        mensajeSecretoTexto.classList.add('visible');
                    });
                    indicadorToca.style.display = 'none';
                    puedeAvanzar = false;
                    setTimeout(function() {
                        var corazonTeamo = document.getElementById('corazon-teamo');
                        if (corazonTeamo) {
                            corazonTeamo.addEventListener('click', function(e) {
                                e.stopPropagation();
                                activarEasterEgg();
                            });
                        }
                    }, 500);
                }
            }, 400);
        }

        faseMensajes.addEventListener('click', function() {
            if (typewriterMensajeIntervalo && !typewriterMensajeTerminado) {
                clearInterval(typewriterMensajeIntervalo);
                typewriterMensajeIntervalo = null;
                typewriterMensajeTerminado = true;
                detenerAudioMaquina();
                var mensaje = MENSAJES_SECRETOS[indiceMensaje];
                mensajeSecretoTexto.innerHTML = mensaje.texto;
                mensajeSecretoTexto.classList.add('texto-largo');
                mensajeSecretoTexto.classList.add('visible');
                indicadorToca.style.opacity = '1';
                setTimeout(function() { puedeAvanzar = true; }, 800);
                return;
            }
            if (!puedeAvanzar) return;
            var siguiente = indiceMensaje + 1;
            if (siguiente < MENSAJES_SECRETOS.length) {
                mostrarMensajeSecreto(siguiente);
            }
        });

        function activarEasterEgg() {
            if (easterActivado) return;
            easterActivado = true;
            faseMensajes.style.opacity = '0';
            setTimeout(function() {
                faseMensajes.style.display = 'none';
                faseEaster.style.display = 'block';
                requestAnimationFrame(function() {
                    faseEaster.classList.add('visible');
                });
                audioEasterFondo.volume = 0.3;
                audioEasterFondo.play().catch(function(e) {});
                setTimeout(function() {
                    mostrarEasterMensaje(0);
                }, 800);
            }, 1000);
        }

        function mostrarEasterMensaje(indice) {
            if (indice >= EASTER_MENSAJES.length) {
                mostrarOpciones();
                return;
            }
            easterIndice = indice;
            easterTexto.classList.remove('visible');
            setTimeout(function() {
                easterTexto.className = '';
                easterTexto.innerHTML = '';
                reproducirBurbujaCorta();
                iniciarAudioMaquina();
                var textoCompleto = EASTER_MENSAJES[indice];
                var letraActual = 0;
                easterTexto.innerHTML = '<span class="cursor-easter">|</span>';
                requestAnimationFrame(function() {
                    easterTexto.classList.add('visible');
                });
                easterPuedeAvanzar = false;
                easterTypewriterTerminado = false;
                easterTypewriterIntervalo = setInterval(function() {
                    if (letraActual < textoCompleto.length) {
                        var cursorE = easterTexto.querySelector('.cursor-easter');
                        if (cursorE) {
                            var nodo = document.createTextNode(textoCompleto[letraActual]);
                            cursorE.parentNode.insertBefore(nodo, cursorE);
                        }
                        letraActual++;
                    } else {
                        clearInterval(easterTypewriterIntervalo);
                        easterTypewriterIntervalo = null;
                        easterTypewriterTerminado = true;
                        detenerAudioMaquina();
                        setTimeout(function() {
                            var cursorE = easterTexto.querySelector('.cursor-easter');
                            if (cursorE) cursorE.style.display = 'none';
                        }, 800);
                        setTimeout(function() {
                            easterPuedeAvanzar = true;
                        }, 1000);
                    }
                }, VELOCIDAD_EASTER_TYPEWRITER);
            }, 400);
        }

        function mostrarOpciones() {
            easterFaseActual = "opciones";
            easterTexto.classList.remove('visible');
            easterIndicador.style.display = 'none';
            setTimeout(function() {
                easterTexto.innerHTML = '';
                easterTexto.style.display = 'none';
                reproducirBurbujaCorta();
                easterOpciones.style.display = 'block';
                requestAnimationFrame(function() {
                    easterOpciones.classList.add('visible');
                });
            }, 600);
        }

        faseEaster.addEventListener('click', function(e) {
            if (e.target.classList.contains('opcion-flotante')) return;
            if (easterFaseActual === "opciones" || easterFaseActual === "finalizado") return;
            if (easterTypewriterIntervalo && !easterTypewriterTerminado) {
                clearInterval(easterTypewriterIntervalo);
                easterTypewriterIntervalo = null;
                easterTypewriterTerminado = true;
                detenerAudioMaquina();
                easterTexto.innerHTML = EASTER_MENSAJES[easterIndice];
                easterTexto.classList.add('visible');
                setTimeout(function() { easterPuedeAvanzar = true; }, 500);
                return;
            }
            if (!easterPuedeAvanzar) return;
            var siguiente = easterIndice + 1;
            if (siguiente < EASTER_MENSAJES.length) {
                mostrarEasterMensaje(siguiente);
            } else {
                mostrarOpciones();
            }
        });

        opcionLuz.addEventListener('click', function(e) {
            e.stopPropagation();
            easterFaseActual = "finalizado";
            reproducirBurbujaCorta();
            faseEaster.style.opacity = '0';
            setTimeout(function() {
                faseEaster.style.display = 'none';
                faseFinal.classList.add('fondo-luz');
                faseFinal.style.display = 'block';
                finalContenido.innerHTML = '';
                var textoLuz = document.createElement('div');
                textoLuz.className = 'final-texto texto-luz-principal';
                finalContenido.appendChild(textoLuz);
                var lineaPequena = document.createElement('div');
                lineaPequena.className = 'final-linea-pequena';
                lineaPequena.textContent = 'Elegir tambien es una forma de revelar quien eres.';
                finalContenido.appendChild(lineaPequena);
                requestAnimationFrame(function() {
                    faseFinal.classList.add('visible');
                });
                var textoCompletoLuz = "Eres un regalo en la logica de mi existencia.";
                var letraLuz = 0;
                setTimeout(function() {
                    reproducirBurbujaCorta();
                    iniciarAudioMaquina();
                    textoLuz.innerHTML = '<span class="cursor-easter">|</span>';
                    textoLuz.classList.add('visible');
                    var intervaloLuz = setInterval(function() {
                        if (letraLuz < textoCompletoLuz.length) {
                            var cursorL = textoLuz.querySelector('.cursor-easter');
                            if (cursorL) {
                                var nodo = document.createTextNode(textoCompletoLuz[letraLuz]);
                                cursorL.parentNode.insertBefore(nodo, cursorL);
                            }
                            letraLuz++;
                        } else {
                            clearInterval(intervaloLuz);
                            detenerAudioMaquina();
                            var cursorL = textoLuz.querySelector('.cursor-easter');
                            if (cursorL) {
                                setTimeout(function() { cursorL.style.display = 'none'; }, 800);
                            }
                            setTimeout(function() {
                                lineaPequena.classList.add('visible');
                            }, 1500);
                        }
                    }, 60);
                }, 1000);
            }, 1000);
        });

        opcionSombras.addEventListener('click', function(e) {
            e.stopPropagation();
            easterFaseActual = "finalizado";
            reproducirBurbujaCorta();
            faseEaster.style.opacity = '0';
            setTimeout(function() {
                faseEaster.style.display = 'none';
                faseFinal.classList.add('fondo-sombras');
                faseFinal.style.display = 'block';
                finalContenido.innerHTML = '';
                var elementos = [];
                for (var i = 0; i < SOMBRAS_PARTES.length; i++) {
                    var parrafo = document.createElement('div');
                    parrafo.className = 'final-texto';
                    finalContenido.appendChild(parrafo);
                    elementos.push(parrafo);
                }
                var lineaPequena = document.createElement('div');
                lineaPequena.className = 'final-linea-pequena';
                lineaPequena.textContent = 'Elegir tambien es una forma de revelar quien eres.';
                finalContenido.appendChild(lineaPequena);
                requestAnimationFrame(function() {
                    faseFinal.classList.add('visible');
                });
                setTimeout(function() {
                    escribirParrafoSombras(0, elementos, lineaPequena);
                }, 1000);
            }, 1000);
        });

        function escribirParrafoSombras(indice, elementos, lineaPequena) {
            if (indice >= SOMBRAS_PARTES.length) {
                setTimeout(function() {
                    lineaPequena.classList.add('visible');
                }, 1500);
                return;
            }
            var elemento = elementos[indice];
            var textoCompleto = SOMBRAS_PARTES[indice];
            var letraActual = 0;
            reproducirBurbujaCorta();
            iniciarAudioMaquina();
            elemento.innerHTML = '<span class="cursor-easter">|</span>';
            elemento.classList.add('visible');
            var intervaloSombra = setInterval(function() {
                if (letraActual < textoCompleto.length) {
                    var cursorS = elemento.querySelector('.cursor-easter');
                    if (cursorS) {
                        var nodo = document.createTextNode(textoCompleto[letraActual]);
                        cursorS.parentNode.insertBefore(nodo, cursorS);
                    }
                    letraActual++;
                } else {
                    clearInterval(intervaloSombra);
                    detenerAudioMaquina();
                    var cursorS = elemento.querySelector('.cursor-easter');
                    if (cursorS) {
                        setTimeout(function() { cursorS.style.display = 'none'; }, 500);
                    }
                    setTimeout(function() {
                        escribirParrafoSombras(indice + 1, elementos, lineaPequena);
                    }, 1200);
                }
            }, VELOCIDAD_EASTER_TYPEWRITER);
        }

        function iniciarCorazones() {
            setInterval(function() {
                crearCorazon();
            }, 800);
        }

        function crearCorazon() {
            var corazon = document.createElement('div');
            corazon.classList.add('corazon');
            var emojis = ['\uD83D\uDC9C', '\uD83D\uDC9C', '\uD83D\uDC9C', '\uD83D\uDFE3', '\uD83D\uDC9C', '\uD83D\uDC9C'];
            corazon.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            corazon.style.left = Math.random() * 100 + 'vw';
            corazon.style.top = '100vh';
            corazon.style.fontSize = (Math.random() * 1.5 + 0.8) + 'rem';
            document.body.appendChild(corazon);
            setTimeout(function() { corazon.remove(); }, 4000);
        }

        function crearParticulas() {
            setInterval(function() {
                var particula = document.createElement('div');
                particula.classList.add('particula');
                particula.style.left = Math.random() * 100 + 'vw';
                particula.style.top = Math.random() * 100 + 'vh';
                particula.style.animation = 'brillar ' + (Math.random() * 2 + 1) + 's ease-in-out';
                document.body.appendChild(particula);
                setTimeout(function() { particula.remove(); }, 3000);
            }, 300);
        }

        crearParticulas();

        function precargarImagenes() {
            var img1 = new Image();
            img1.src = IMAGEN_GATO_1;
            var img2 = new Image();
            img2.src = IMAGEN_GATO_2;
        }

        precargarImagenes();
    </script>

</body>
</html>