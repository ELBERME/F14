<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noris üíú</title>

    <style>
        /* --- RESET GENERAL --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000;
            font-family: 'Georgia', 'Times New Roman', serif;
        }

        /* ============================================= */
        /* FASE 1: VIDEO DE FONDO                        */
        /* ============================================= */
        #fase-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            transition: opacity 1.5s ease-in-out;
        }

        #video-fondo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
        }

        #overlay-oscuro {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.35);
            z-index: 2;
        }

        /* ============================================= */
        /* TEXTO TYPEWRITER FASE 1                       */
        /* ============================================= */
        #contenedor-texto {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            text-align: center;
            width: 90%;
            max-width: 800px;
        }

        #texto-animado {
            color: #fff;
            font-size: clamp(1.8rem, 5vw, 4rem);
            text-shadow:
                0 0 10px rgba(155, 89, 182, 0.8),
                0 0 20px rgba(155, 89, 182, 0.6),
                0 0 40px rgba(155, 89, 182, 0.4),
                2px 2px 4px rgba(0, 0, 0, 0.8);
            letter-spacing: 3px;
            line-height: 1.4;
            font-style: italic;
            white-space: pre-wrap;
            min-height: 2em;
        }

        #cursor {
            display: inline-block;
            width: 3px;
            height: 1em;
            background-color: #9b59b6;
            margin-left: 4px;
            vertical-align: text-bottom;
            animation: parpadeo 0.6s infinite;
        }

        @keyframes parpadeo {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* ============================================= */
        /* FASE 2: VIDEO BORROSO + GATO                  */
        /* ============================================= */
        #fase-gif {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            display: none;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
        }

        #video-borroso {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
            filter: blur(15px) brightness(0.5);
        }

        #contenedor-gif {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            z-index: 11;
            text-align: center;
            opacity: 0;
            transition: all 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        #contenedor-gif.visible {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        #gif-gato {
            max-width: 80vw;
            max-height: 60vh;
            border-radius: 20px;
            box-shadow:
                0 0 30px rgba(155, 89, 182, 0.6),
                0 0 60px rgba(155, 89, 182, 0.3);
            border: 3px solid rgba(155, 89, 182, 0.5);
            cursor: pointer;
        }

        #texto-final {
            color: #9b59b6;
            font-size: clamp(1.2rem, 3vw, 2.5rem);
            margin-top: 20px;
            text-shadow:
                0 0 10px rgba(155, 89, 182, 0.8),
                0 0 20px rgba(155, 89, 182, 0.5);
            opacity: 0;
            transition: opacity 1s ease-in-out 0.5s;
        }

        #texto-final.visible {
            opacity: 1;
        }

        /* ============================================= */
        /* CORAZONES FLOTANTES                           */
        /* ============================================= */
        .corazon {
            position: fixed;
            z-index: 20;
            font-size: 1.5rem;
            opacity: 0;
            pointer-events: none;
            animation: flotar-corazon 4s ease-in-out forwards;
        }

        @keyframes flotar-corazon {
            0% {
                opacity: 0;
                transform: translateY(0) scale(0.5);
            }
            20% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(-100vh) scale(1.2);
            }
        }

        /* ============================================= */
        /* BOTON DE INICIO                                */
        /* ============================================= */
        #boton-inicio {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: clamp(1.2rem, 3vw, 2rem);
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Georgia', serif;
            box-shadow:
                0 0 20px rgba(155, 89, 182, 0.6),
                0 0 40px rgba(155, 89, 182, 0.3);
            transition: all 0.3s ease;
            animation: pulsar-boton 2s ease-in-out infinite;
        }

        #boton-inicio:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow:
                0 0 30px rgba(155, 89, 182, 0.8),
                0 0 60px rgba(155, 89, 182, 0.5);
        }

        @keyframes pulsar-boton {
            0%, 100% { box-shadow: 0 0 20px rgba(155, 89, 182, 0.6); }
            50% { box-shadow: 0 0 40px rgba(155, 89, 182, 0.9), 0 0 80px rgba(155, 89, 182, 0.4); }
        }

        /* ============================================= */
        /* PARTICULAS                                    */
        /* ============================================= */
        .particula {
            position: fixed;
            width: 4px;
            height: 4px;
            background: #9b59b6;
            border-radius: 50%;
            pointer-events: none;
            z-index: 15;
            opacity: 0;
        }

        /* ============================================= */
        /* FASE 3: MENSAJES SECRETOS                     */
        /* ============================================= */
        #fase-mensajes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 50;
            display: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background: rgba(0, 0, 0, 0.9);
        }

        #fase-mensajes.visible {
            opacity: 1;
        }

        #contenedor-mensaje-secreto {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 85%;
            max-width: 700px;
        }

        /* Texto de los mensajes cortos */
        #mensaje-secreto-texto {
            color: #fff;
            font-size: clamp(1.4rem, 4vw, 2.8rem);
            text-shadow:
                0 0 10px rgba(155, 89, 182, 0.8),
                0 0 20px rgba(155, 89, 182, 0.6),
                0 0 40px rgba(155, 89, 182, 0.4);
            line-height: 1.6;
            font-style: italic;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            white-space: pre-wrap;
        }

        #mensaje-secreto-texto.visible {
            opacity: 1;
        }

        /* Clase para el texto largo (parrafo) */
        #mensaje-secreto-texto.texto-largo {
            font-size: clamp(1rem, 2.8vw, 1.6rem);
            line-height: 1.8;
            font-style: italic;
        }

        /* Clase para TE AMO gigante */
        #mensaje-secreto-texto.texto-teamo {
            font-size: clamp(3rem, 12vw, 8rem);
            font-weight: bold;
            font-style: normal;
            text-shadow:
                0 0 20px rgba(155, 89, 182, 1),
                0 0 40px rgba(155, 89, 182, 0.8),
                0 0 80px rgba(155, 89, 182, 0.6),
                0 0 120px rgba(155, 89, 182, 0.4);
            animation: latido-teamo 1.5s ease-in-out infinite;
        }

        @keyframes latido-teamo {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Cursor para el typewriter de los mensajes */
        #cursor-mensaje {
            display: inline-block;
            width: 3px;
            height: 1em;
            background-color: #9b59b6;
            margin-left: 4px;
            vertical-align: text-bottom;
            animation: parpadeo 0.6s infinite;
        }

        /* Indicador de toca para continuar */
        #indicador-toca {
            position: absolute;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(155, 89, 182, 0.6);
            font-size: clamp(0.8rem, 2vw, 1rem);
            animation: parpadeo-suave 2s ease-in-out infinite;
        }

        @keyframes parpadeo-suave {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }

        /* ============================================= */
        /* MEDIA QUERIES                                 */
        /* ============================================= */
        @media (max-width: 768px) {
            #gif-gato {
                max-width: 90vw;
                max-height: 50vh;
            }
            #contenedor-texto {
                width: 95%;
            }
            #boton-inicio {
                padding: 15px 35px;
            }
            #contenedor-mensaje-secreto {
                width: 90%;
            }
        }

        @media (max-width: 480px) {
            #gif-gato {
                max-width: 95vw;
                max-height: 45vh;
                border-radius: 15px;
            }
            #contenedor-mensaje-secreto {
                width: 93%;
            }
        }
    </style>
</head>
<body>

    <!-- BOTON DE INICIO -->
    <button id="boton-inicio">üíú Toca para comenzar üíú</button>

    <!-- FASE 1: VIDEO + TEXTO ANIMADO -->
    <div id="fase-video">
        <video id="video-fondo" muted playsinline>
            <source src="video.mp4" type="video/mp4">
        </video>
        <div id="overlay-oscuro"></div>
        <div id="contenedor-texto">
            <span id="texto-animado"></span>
            <span id="cursor">|</span>
        </div>
    </div>

    <!-- FASE 2: VIDEO BORROSO + GIF DEL GATO -->
    <div id="fase-gif">
        <video id="video-borroso" loop muted playsinline>
            <source src="video.mp4" type="video/mp4">
        </video>
        <div id="contenedor-gif">
            <img id="gif-gato" src="imagen uno.jpeg" alt="Gatito con flor">
            <div id="texto-final">üíú Te quiero mucho, Noris üíú</div>
        </div>
    </div>

    <!-- FASE 3: MENSAJES SECRETOS -->
    <div id="fase-mensajes">
        <div id="contenedor-mensaje-secreto">
            <div id="mensaje-secreto-texto"></div>
        </div>
        <div id="indicador-toca">toca para continuar</div>
    </div>

    <!-- AUDIOS -->
    <audio id="audio-principal" preload="auto">
        <source src="video audio.mpeg" type="audio/mpeg">
    </audio>

    <audio id="audio-typewriter" preload="auto" loop>
        <source src="maquina de escribir audio.mpeg" type="audio/mpeg">
    </audio>

    <audio id="audio-burbuja" preload="auto" loop>
        <source src="audio de burbuja.mpeg" type="audio/mpeg">
    </audio>

    <!-- ============================================= -->
    <!-- AUDIO DE BURBUJA CORTO (un solo pop)           -->
    <!-- Se usa para los mensajes secretos              -->
    <!-- Usa el MISMO archivo de burbuja                -->
    <!-- ============================================= -->
    <audio id="audio-burbuja-corto" preload="auto">
        <source src="audio de burbuja.mpeg" type="audio/mpeg">
    </audio>

    <script>
        // ============================================= 
        // CONFIGURACION PRINCIPAL
        // ============================================= 
        var MENSAJE = "Feliz 14 de Febrero\nNoris üíú";
        var DURACION_VIDEO = 13000;
        var ESPERA_INICIO_TEXTO = 1500;
        var TIEMPO_DISPONIBLE_TEXTO = DURACION_VIDEO - ESPERA_INICIO_TEXTO - 2000;
        var VELOCIDAD_LETRA = Math.floor(TIEMPO_DISPONIBLE_TEXTO / MENSAJE.length);

        var IMAGEN_GATO_1 = "imagen uno.jpeg";
        var IMAGEN_GATO_2 = "iamgen 2.jpeg";
        var VELOCIDAD_GIF = 600;

        // ============================================= 
        // MENSAJES SECRETOS
        // tipo: "normal" = aparece de golpe con burbuja
        // tipo: "typewriter" = se escribe letra por letra
        // tipo: "teamo" = aparece grande con animacion
        // ============================================= 
        var MENSAJES_SECRETOS = [
            {
                texto: "Ya veo... andas de curiosa üëÄ",
                tipo: "normal"
            },
            {
                texto: "Eso me gusta de ti üòèüíú",
                tipo: "normal"
            },
            {
                texto: "Toma esto... üéÅ",
                tipo: "normal"
            },
            {
                texto: "En algun lugar de estas infinitas palabras organizadas, esta este texto. Texto que se creo pensando en ti, por un impulso que nacio del azar, espontaneo e imparcial, incluso inalterable. Texto el cual se escribio con el unico fin de recordarte que...",
                tipo: "typewriter"
            },
            {
                texto: "TE AMO üíú",
                tipo: "teamo"
            }
        ];

        // Velocidad del typewriter en los mensajes (ms por letra)
        var VELOCIDAD_MENSAJE_TYPEWRITER = 55;

        // ============================================= 
        // REFERENCIAS A ELEMENTOS
        // ============================================= 
        var botonInicio = document.getElementById('boton-inicio');
        var faseVideo = document.getElementById('fase-video');
        var faseGif = document.getElementById('fase-gif');
        var faseMensajes = document.getElementById('fase-mensajes');
        var videoFondo = document.getElementById('video-fondo');
        var videoBorroso = document.getElementById('video-borroso');
        var textoAnimado = document.getElementById('texto-animado');
        var cursorElemento = document.getElementById('cursor');
        var contenedorGif = document.getElementById('contenedor-gif');
        var gifGato = document.getElementById('gif-gato');
        var textoFinal = document.getElementById('texto-final');
        var audioPrincipal = document.getElementById('audio-principal');
        var audioTypewriter = document.getElementById('audio-typewriter');
        var audioBurbuja = document.getElementById('audio-burbuja');
        var audioBurbujaCorto = document.getElementById('audio-burbuja-corto');
        var mensajeSecretoTexto = document.getElementById('mensaje-secreto-texto');
        var indicadorToca = document.getElementById('indicador-toca');

        // Variables de control
        var indiceLetra = 0;
        var intervaloTexto = null;
        var intervaloGif = null;
        var imagenActual = 1;
        var transicionEjecutada = false;

        // Variables para mensajes secretos
        var indiceMensaje = 0;
        var mensajesActivados = false;
        var puedeAvanzar = false;
        var typewriterMensajeIntervalo = null;
        var typewriterMensajeTerminado = false;

        // ============================================= 
        // BOTON DE INICIO
        // ============================================= 
        botonInicio.addEventListener('click', function() {
            var btn = this;
            btn.style.transition = 'opacity 0.5s ease';
            btn.style.opacity = '0';

            setTimeout(function() {
                btn.style.display = 'none';
                iniciarExperiencia();
            }, 500);
        });

        // ============================================= 
        // FUNCION PRINCIPAL
        // ============================================= 
        function iniciarExperiencia() {
            videoFondo.play().catch(function(e) { console.log('Error video:', e); });
            audioPrincipal.play().catch(function(e) { console.log('Error audio:', e); });

            setTimeout(function() {
                iniciarTextoTypewriter();
            }, ESPERA_INICIO_TEXTO);

            videoFondo.addEventListener('ended', transicionAFase2);

            setTimeout(function() {
                transicionAFase2();
            }, DURACION_VIDEO + 500);

            iniciarCorazones();
        }

        // ============================================= 
        // EFECTO TYPEWRITER FASE 1
        // ============================================= 
        function iniciarTextoTypewriter() {
            audioTypewriter.volume = 0.5;
            audioTypewriter.play().catch(function(e) { console.log('Error typewriter:', e); });

            intervaloTexto = setInterval(function() {
                if (indiceLetra < MENSAJE.length) {
                    var letra = MENSAJE[indiceLetra];
                    if (letra === '\n') {
                        textoAnimado.innerHTML += '<br>';
                    } else {
                        textoAnimado.innerHTML += letra;
                    }
                    indiceLetra++;
                } else {
                    clearInterval(intervaloTexto);
                    audioTypewriter.pause();
                    audioTypewriter.currentTime = 0;
                    setTimeout(function() {
                        cursorElemento.style.display = 'none';
                    }, 1000);
                }
            }, VELOCIDAD_LETRA);
        }

        // ============================================= 
        // TRANSICION FASE 1 A FASE 2
        // ============================================= 
        function transicionAFase2() {
            if (transicionEjecutada) return;
            transicionEjecutada = true;

            if (intervaloTexto) {
                clearInterval(intervaloTexto);
                audioTypewriter.pause();
            }

            faseVideo.style.opacity = '0';

            setTimeout(function() {
                faseVideo.style.display = 'none';
                faseGif.style.display = 'block';
                videoBorroso.play().catch(function(e) { console.log('Error video borroso:', e); });

                requestAnimationFrame(function() {
                    faseGif.style.opacity = '1';
                });

                setTimeout(function() {
                    contenedorGif.classList.add('visible');
                    iniciarGifManual();

                    // Iniciar audio de burbuja en loop para el gato
                    audioBurbuja.volume = 0.5;
                    audioBurbuja.play().catch(function(e) { console.log('Error burbuja:', e); });

                    setTimeout(function() {
                        textoFinal.classList.add('visible');
                    }, 800);
                }, 500);

            }, 1500);
        }

        // ============================================= 
        // GIF MANUAL: Alterna las 2 imagenes del gato
        // ============================================= 
        function iniciarGifManual() {
            intervaloGif = setInterval(function() {
                if (imagenActual === 1) {
                    gifGato.src = IMAGEN_GATO_2;
                    imagenActual = 2;
                } else {
                    gifGato.src = IMAGEN_GATO_1;
                    imagenActual = 1;
                }
            }, VELOCIDAD_GIF);
        }

        // ============================================= 
        // REPRODUCIR BURBUJA CORTA (un solo pop)
        // Para los mensajes secretos
        // ============================================= 
        function reproducirBurbujaCorta() {
            audioBurbujaCorto.currentTime = 0;
            audioBurbujaCorto.volume = 0.7;
            audioBurbujaCorto.play().catch(function(e) { console.log('Error burbuja corta:', e); });
        }

        // ============================================= 
        // TOCAR EL GATO: Activa mensajes secretos
        // ============================================= 
        gifGato.addEventListener('click', function() {
            if (mensajesActivados) return;
            mensajesActivados = true;

            // Detener GIF y audio de burbuja loop
            if (intervaloGif) {
                clearInterval(intervaloGif);
            }
            audioBurbuja.pause();
            audioBurbuja.currentTime = 0;

            // Transicion: ocultar fase del gato
            faseGif.style.opacity = '0';

            setTimeout(function() {
                faseGif.style.display = 'none';

                // Mostrar fase de mensajes
                faseMensajes.style.display = 'block';
                requestAnimationFrame(function() {
                    faseMensajes.classList.add('visible');
                });

                // Mostrar primer mensaje con sonido de burbuja
                setTimeout(function() {
                    mostrarMensaje(0);
                }, 800);

            }, 1000);
        });

        // ============================================= 
        // MOSTRAR MENSAJE SECRETO
        // Maneja 3 tipos: normal, typewriter y teamo
        // ============================================= 
        function mostrarMensaje(indice) {
            if (indice >= MENSAJES_SECRETOS.length) return;

            indiceMensaje = indice;
            var mensaje = MENSAJES_SECRETOS[indice];

            // Detener typewriter anterior si habia uno
            if (typewriterMensajeIntervalo) {
                clearInterval(typewriterMensajeIntervalo);
                typewriterMensajeIntervalo = null;
            }
            typewriterMensajeTerminado = false;

            // Ocultar texto actual
            mensajeSecretoTexto.classList.remove('visible');

            setTimeout(function() {
                // Limpiar clases y contenido
                mensajeSecretoTexto.className = '';
                mensajeSecretoTexto.innerHTML = '';

                // ============================================= 
                // TIPO "normal": Aparece de golpe con burbuja
                // Para los mensajes cortos (curiosa, me gusta, toma)
                // ============================================= 
                if (mensaje.tipo === "normal") {
                    // Reproducir sonido de burbuja
                    reproducirBurbujaCorta();

                    mensajeSecretoTexto.innerHTML = mensaje.texto;

                    requestAnimationFrame(function() {
                        mensajeSecretoTexto.classList.add('visible');
                    });

                    // Permitir avanzar despues de 1.5s
                    puedeAvanzar = false;
                    setTimeout(function() {
                        puedeAvanzar = true;
                    }, 1500);
                }

                // ============================================= 
                // TIPO "typewriter": Se escribe letra por letra
                // Para el texto largo del parrafo
                // Incluye cursor parpadeante y audio maquina
                // ============================================= 
                else if (mensaje.tipo === "typewriter") {
                    // Reproducir burbuja al iniciar
                    reproducirBurbujaCorta();

                    // Agregar clase de texto largo
                    mensajeSecretoTexto.classList.add('texto-largo');

                    // Hacer visible el contenedor
                    requestAnimationFrame(function() {
                        mensajeSecretoTexto.classList.add('visible');
                    });

                    // Ocultar el indicador de toca mientras se escribe
                    indicadorToca.style.opacity = '0';

                    // Bloquear avance mientras se escribe
                    puedeAvanzar = false;

                    // Iniciar audio de maquina de escribir
                    audioTypewriter.currentTime = 0;
                    audioTypewriter.volume = 0.4;
                    audioTypewriter.play().catch(function(e) { console.log('Error typewriter msg:', e); });

                    // Variables para el typewriter del mensaje
                    var textoCompleto = mensaje.texto;
                    var letraActual = 0;

                    // Agregar cursor parpadeante
                    mensajeSecretoTexto.innerHTML = '<span id="cursor-mensaje">|</span>';

                    typewriterMensajeIntervalo = setInterval(function() {
                        if (letraActual < textoCompleto.length) {
                            var letra = textoCompleto[letraActual];

                            // Obtener el cursor
                            var cursorMsg = document.getElementById('cursor-mensaje');

                            // Insertar la letra ANTES del cursor
                            if (cursorMsg) {
                                var textoNodo = document.createTextNode(letra);
                                cursorMsg.parentNode.insertBefore(textoNodo, cursorMsg);
                            }

                            letraActual++;
                        } else {
                            // Termino de escribir
                            clearInterval(typewriterMensajeIntervalo);
                            typewriterMensajeIntervalo = null;
                            typewriterMensajeTerminado = true;

                            // Detener audio de maquina
                            audioTypewriter.pause();
                            audioTypewriter.currentTime = 0;

                            // Ocultar cursor despues de 1s
                            setTimeout(function() {
                                var cursorMsg = document.getElementById('cursor-mensaje');
                                if (cursorMsg) {
                                    cursorMsg.style.display = 'none';
                                }
                            }, 1000);

                            // Mostrar indicador y permitir avanzar
                            indicadorToca.style.opacity = '1';
                            setTimeout(function() {
                                puedeAvanzar = true;
                            }, 1500);
                        }
                    }, VELOCIDAD_MENSAJE_TYPEWRITER);
                }

                // ============================================= 
                // TIPO "teamo": Texto gigante con animacion
                // Se queda en pantalla permanentemente
                // ============================================= 
                else if (mensaje.tipo === "teamo") {
                    // Reproducir burbuja al aparecer
                    reproducirBurbujaCorta();

                    mensajeSecretoTexto.innerHTML = mensaje.texto;
                    mensajeSecretoTexto.classList.add('texto-teamo');

                    requestAnimationFrame(function() {
                        mensajeSecretoTexto.classList.add('visible');
                    });

                    // Ocultar indicador (ya no hay mas mensajes)
                    indicadorToca.style.display = 'none';

                    // No se puede avanzar mas
                    puedeAvanzar = false;
                }

            }, 400);
        }

        // ============================================= 
        // TOCAR PANTALLA PARA AVANZAR MENSAJES
        // ============================================= 
        faseMensajes.addEventListener('click', function() {
            // Si esta escribiendo el typewriter y tocan la pantalla,
            // completar el texto de golpe
            if (typewriterMensajeIntervalo && !typewriterMensajeTerminado) {
                // Detener el typewriter
                clearInterval(typewriterMensajeIntervalo);
                typewriterMensajeIntervalo = null;
                typewriterMensajeTerminado = true;

                // Detener audio de maquina
                audioTypewriter.pause();
                audioTypewriter.currentTime = 0;

                // Mostrar el texto completo de golpe
                var mensaje = MENSAJES_SECRETOS[indiceMensaje];
                mensajeSecretoTexto.innerHTML = mensaje.texto;
                mensajeSecretoTexto.classList.add('texto-largo');
                mensajeSecretoTexto.classList.add('visible');

                // Mostrar indicador y permitir avanzar
                indicadorToca.style.opacity = '1';
                setTimeout(function() {
                    puedeAvanzar = true;
                }, 800);

                return;
            }

            // Si no puede avanzar todavia, no hacer nada
            if (!puedeAvanzar) return;

            var siguienteIndice = indiceMensaje + 1;

            if (siguienteIndice < MENSAJES_SECRETOS.length) {
                mostrarMensaje(siguienteIndice);
            }
        });

        // ============================================= 
        // CORAZONES FLOTANTES MORADOS
        // ============================================= 
        function iniciarCorazones() {
            setInterval(function() {
                crearCorazon();
            }, 800);
        }

        function crearCorazon() {
            var corazon = document.createElement('div');
            corazon.classList.add('corazon');

            var emojis = ['üíú', 'üíú', 'üíú', 'üü£', 'üíú', 'üíú'];
            corazon.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];

            corazon.style.left = Math.random() * 100 + 'vw';
            corazon.style.top = '100vh';
            corazon.style.fontSize = (Math.random() * 1.5 + 0.8) + 'rem';

            document.body.appendChild(corazon);

            setTimeout(function() {
                corazon.remove();
            }, 4000);
        }

        // ============================================= 
        // PARTICULAS DE BRILLO
        // ============================================= 
        function crearParticulas() {
            setInterval(function() {
                var particula = document.createElement('div');
                particula.classList.add('particula');
                particula.style.left = Math.random() * 100 + 'vw';
                particula.style.top = Math.random() * 100 + 'vh';
                particula.style.animation = 'brillar ' + (Math.random() * 2 + 1) + 's ease-in-out';
                document.body.appendChild(particula);
                setTimeout(function() { particula.remove(); }, 3000);
            }, 300);
        }

        crearParticulas();

        // ============================================= 
        // PRE-CARGAR IMAGENES
        // ============================================= 
        function precargarImagenes() {
            var img1 = new Image();
            img1.src = IMAGEN_GATO_1;
            var img2 = new Image();
            img2.src = IMAGEN_GATO_2;
        }

        precargarImagenes();
    </script>

</body>
</html>